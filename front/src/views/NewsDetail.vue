<script>
import axios from 'axios';

export default {
  name: 'NewsDetail',
  props: ['id'], // 라우터에서 전달된 ID를 props로 받음
  data() {
    return {
      article: null,
    };
  },
  created() {
    this.fetchArticle();
  },
  methods: {
    fetchArticle() {
      axios
        .get(`http://localhost:8000/api/news/${this.id}/`)
        .then((response) => {
          this.article = response.data;
        })
        .catch((error) => {
          console.error('Error fetching article:', error);
        });
    },
  },
};
</script>

<template>
  <div class="news-page-container">
    <!-- 뉴스 상세보기 및 챗봇 섹션 래퍼 -->
    <div class="left-section-wrapper">
      <!-- 뉴스 상세보기 섹션 -->
      <section class="news-detail-section">
        <div v-if="article" class="news-detail-container">
          <h1 class="news-detail-title">{{ article.title }}</h1>
          <div class="news-detail-info">
            <p>작성일: {{ article.date }}</p>
            <p>분류: {{ article.category }}</p>
          </div>
          <div class="news-detail-content">
            <p>{{ article.content }}</p>
          </div>
          <!-- 키워드 태그 섹션 -->
          <div class="news-detail-keywords">
            <span v-for="(keyword, index) in article.keywords.split(',')" :key="index" class="keyword-tag">
              {{ keyword.trim() }}
            </span>
          </div>
        </div>
        <div v-else>
          <p>뉴스 기사를 불러오는 중입니다...</p>
        </div>
      </section>

      <!-- AI 뉴스비서 섹션 -->
      <section class="chatbot-section">
        <h2>AI 뉴스비서 뉴비</h2>
        <p>뉴비에게 이 기사에 대해 궁금한 점을 자유롭게 물어보세요!</p>
        <div class="chat-container">
          <div class="chat-message user-message">안녕</div>
          <div class="chat-message ai-message">
            안녕하세요! 😊 어떻게 도와드릴까요? 보고 계신 뉴스에 대해 궁금한 점이 있으시면 언제든지 질문해 주세요!
          </div>
        </div>
        <input type="text" placeholder="질문을 입력하세요..." />
      </section>
    </div>

    <!-- 관련 기사 섹션 -->
    <aside class="related-articles-section">
      <h2>관련 기사</h2>
      <ul class="related-articles-list">
        <li v-for="related in relatedArticles" :key="related.id" class="related-article-item">
          <h3>{{ related.title }}</h3>
          <p>{{ related.date }}</p>
        </li>
      </ul>
    </aside>
  </div>
</template>

<style scoped>
/* #region Header Styles */
.news-page-container {
  display: grid;
  grid-template-columns: 2fr 1fr; /* 왼쪽에 뉴스 상세보기와 챗봇(2)과 오른쪽에 관련 기사(1) */
  gap: 20px;
  padding: 20px;
}

/* 왼쪽 섹션 래퍼 (뉴스 상세보기 및 챗봇) */
.left-section-wrapper {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* 뉴스 상세보기 섹션 스타일 */
.news-detail-section {
  background-color: #ffffff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.news-detail-container {
  max-width: 800px;
  margin: 0 auto;
}

.news-detail-title {
  font-size: 2em;
  font-weight: bold;
  margin-bottom: 15px;
}

.news-detail-info {
  color: #777;
  font-size: 0.9em;
  margin-bottom: 20px;
}

.news-detail-content {
  line-height: 1.6;
  font-size: 1.1em;
  margin-bottom: 20px;
}

/* 키워드 태그 스타일 */
.news-detail-keywords {
  margin-top: 20px;
}

.keyword-tag {
  display: inline-block;
  background-color: #e0e0e0;
  color: #333;
  padding: 5px 10px;
  margin: 5px 5px 0 0;
  border-radius: 15px;
  font-size: 0.9em;
}

/* AI 뉴스비서 섹션 스타일 */
.chatbot-section {
  background-color: #f9f9f9;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.chat-container {
  margin-bottom: 10px;
}

.chat-message {
  padding: 10px;
  border-radius: 5px;
  margin-bottom: 5px;
}

.user-message {
  background-color: #d9edf7;
  text-align: right;
}

.ai-message {
  background-color: #f1f1f1;
  text-align: left;
}

/* 관련 기사 섹션 스타일 */
.related-articles-section {
  background-color: #ffffff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
  position: sticky;
  top: 20px; /* 화면에 고정시키기 위해 사용 */
  align-self: start;
}

.related-articles-list {
  list-style: none;
  padding: 0;
}

.related-article-item {
  margin-bottom: 15px;
}

.related-article-item h3 {
  font-size: 1em;
  margin: 0 0 5px;
}

.related-article-item p {
  font-size: 0.9em;
  color: #777;
  margin: 0;
}
/* #endregion */
</style>
